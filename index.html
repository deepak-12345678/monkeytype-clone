<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>monkey type</title>
    <link rel="stylesheet" href="style.css" />
    <script src="app.js" defer></script>
    <script
      src="https://kit.fontawesome.com/f8c1fa29ab.js"
      crossorigin="anonymous"
    ></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Exo+2:wght@900&family=Kanit:wght@500&family=Kdam+Thmor+Pro&family=Noto+Sans+JP:wght@300&family=Oleo+Script+Swash+Caps&family=Oswald&family=Playfair+Display:ital,wght@1,700&family=Questrial&family=Saira:wght@400;500&family=Water+Brush&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <nav>
      <div class="tba">
        <svg
          width="50"
          height="30"
          fill="#e2b714"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          style="isolation: isolate"
          viewBox="-680 -1030 300 180"
        >
          <g>
            <path
              d="M -430 -910 L -430 -910 C -424.481 -910 -420 -905.519 -420 -900 L -420 -900 C -420 -894.481 -424.481 -890 -430 -890 L -430 -890 C -435.519 -890 -440 -894.481 -440 -900 L -440 -900 C -440 -905.519 -435.519 -910 -430 -910 Z"
            ></path>
            <path
              d=" M -570 -910 L -510 -910 C -504.481 -910 -500 -905.519 -500 -900 L -500 -900 C -500 -894.481 -504.481 -890 -510 -890 L -570 -890 C -575.519 -890 -580 -894.481 -580 -900 L -580 -900 C -580 -905.519 -575.519 -910 -570 -910 Z "
            ></path>
            <path
              d="M -590 -970 L -590 -970 C -584.481 -970 -580 -965.519 -580 -960 L -580 -940 C -580 -934.481 -584.481 -930 -590 -930 L -590 -930 C -595.519 -930 -600 -934.481 -600 -940 L -600 -960 C -600 -965.519 -595.519 -970 -590 -970 Z"
            ></path>
            <path
              d=" M -639.991 -960.515 C -639.72 -976.836 -626.385 -990 -610 -990 L -610 -990 C -602.32 -990 -595.31 -987.108 -590 -982.355 C -584.69 -987.108 -577.68 -990 -570 -990 L -570 -990 C -553.615 -990 -540.28 -976.836 -540.009 -960.515 C -540.001 -960.345 -540 -960.172 -540 -960 L -540 -960 L -540 -940 C -540 -934.481 -544.481 -930 -550 -930 L -550 -930 C -555.519 -930 -560 -934.481 -560 -940 L -560 -960 L -560 -960 C -560 -965.519 -564.481 -970 -570 -970 C -575.519 -970 -580 -965.519 -580 -960 L -580 -960 L -580 -960 L -580 -940 C -580 -934.481 -584.481 -930 -590 -930 L -590 -930 C -595.519 -930 -600 -934.481 -600 -940 L -600 -960 L -600 -960 L -600 -960 L -600 -960 L -600 -960 L -600 -960 L -600 -960 L -600 -960 C -600 -965.519 -604.481 -970 -610 -970 C -615.519 -970 -620 -965.519 -620 -960 L -620 -960 L -620 -940 C -620 -934.481 -624.481 -930 -630 -930 L -630 -930 C -635.519 -930 -640 -934.481 -640 -940 L -640 -960 L -640 -960 C -640 -960.172 -639.996 -960.344 -639.991 -960.515 Z "
            ></path>
            <path
              d=" M -460 -930 L -460 -900 C -460 -894.481 -464.481 -890 -470 -890 L -470 -890 C -475.519 -890 -480 -894.481 -480 -900 L -480 -930 L -508.82 -930 C -514.99 -930 -520 -934.481 -520 -940 L -520 -940 C -520 -945.519 -514.99 -950 -508.82 -950 L -431.18 -950 C -425.01 -950 -420 -945.519 -420 -940 L -420 -940 C -420 -934.481 -425.01 -930 -431.18 -930 L -460 -930 Z "
            ></path>
            <path
              d="M -470 -990 L -430 -990 C -424.481 -990 -420 -985.519 -420 -980 L -420 -980 C -420 -974.481 -424.481 -970 -430 -970 L -470 -970 C -475.519 -970 -480 -974.481 -480 -980 L -480 -980 C -480 -985.519 -475.519 -990 -470 -990 Z"
            ></path>
            <path
              d=" M -630 -910 L -610 -910 C -604.481 -910 -600 -905.519 -600 -900 L -600 -900 C -600 -894.481 -604.481 -890 -610 -890 L -630 -890 C -635.519 -890 -640 -894.481 -640 -900 L -640 -900 C -640 -905.519 -635.519 -910 -630 -910 Z "
            ></path>
            <path
              d=" M -515 -990 L -510 -990 C -504.481 -990 -500 -985.519 -500 -980 L -500 -980 C -500 -974.481 -504.481 -970 -510 -970 L -515 -970 C -520.519 -970 -525 -974.481 -525 -980 L -525 -980 C -525 -985.519 -520.519 -990 -515 -990 Z "
            ></path>
            <path
              d=" M -660 -910 L -680 -910 L -680 -980 C -680 -1007.596 -657.596 -1030 -630 -1030 L -430 -1030 C -402.404 -1030 -380 -1007.596 -380 -980 L -380 -900 C -380 -872.404 -402.404 -850 -430 -850 L -630 -850 C -657.596 -850 -680 -872.404 -680 -900 L -680 -920 L -660 -920 L -660 -900 C -660 -883.443 -646.557 -870 -630 -870 L -430 -870 C -413.443 -870 -400 -883.443 -400 -900 L -400 -980 C -400 -996.557 -413.443 -1010 -430 -1010 L -630 -1010 C -646.557 -1010 -660 -996.557 -660 -980 L -660 -910 Z "
            ></path>
          </g>
        </svg>
        <div class="monkey">
          <div class="see">monkey see</div>
          <div class="type">monkeytype</div>
        </div>
        <div class="logo">
          <div class="kb"><i class="fa-solid fa-keyboard"></i></div>
          <div class="crown"><i class="fa-solid fa-crown"></i></div>
          <div class="i"><i class="fa-solid fa-info"></i></div>
          <div class="set"><i class="fa-solid fa-gear"></i></div>
          <div class="user"><i class="fa-solid fa-user"></i></div>
        </div>
      </div>
      <div class="time">
        Time:
        <div class="fifteen">15s</div>
        <div class="thirty">30s</div>
        <div class="sixty time_select">60s</div>
        <div class="twomin">120s</div>
      </div>
    </nav>
    <div class="timer">1:00</div>
    <div class="quoteBox">
      <div class="quoteDisplay"></div>
      <div class="spbox"><textarea class="quoteType"></textarea></div>
      <div class="bigdiv"></div>
    </div>
    <center>
      <div class="play"><button class="start">START</button></div>
      <button class="restart">RESTART</button>
    </center>
    <center><div class="wpm"></div></center>
  </body>
  <script>
    let dummy = true;
    let mode = 60;
    let go = false;

    if (document.querySelector(".fifteen").classList.contains("time_select")) {
      mode = 15;
      console.log("running");
    } else if (
      document.querySelector(".thirty").classList.contains("time_select")
    ) {
      mode = 30;
      console.log("running");
    } else if (
      document.querySelector(".sixty").classList.contains("time_select")
    ) {
      mode = 60;
      console.log("running");
    }
    if (document.querySelector(".twomin").classList.contains("time_select")) {
      mode = 120;
      console.log("running");
    }
    document.querySelector(".fifteen").addEventListener("click", () => {
      if (mode === 15) {
        document.querySelector(".fifteen").classList.remove("time_select");
        console.log("removing");
      }
      if (mode === 30) {
        document.querySelector(".thirty").classList.remove("time_select");
        console.log("removing");
      }
      if (mode === 60) {
        document.querySelector(".sixty").classList.remove("time_select");
        console.log("removing");
      }
      if (mode === 120) {
        document.querySelector(".twomin").classList.remove("time_select");
        console.log("removing");
      }
      document.querySelector(".fifteen").classList.add("time_select");
      mode = 15;
      console.log(`setting mode=${mode}`);
    });
    document.querySelector(".thirty").addEventListener("click", () => {
      if (mode === 15) {
        document.querySelector(".fifteen").classList.remove("time_select");
      }
      if (mode === 30) {
        document.querySelector(".thirty").classList.remove("time_select");
      }
      if (mode === 60) {
        document.querySelector(".sixty").classList.remove("time_select");
      }
      if (mode === 120) {
        document.querySelector(".twomin").classList.remove("time_select");
      }
      document.querySelector(".thirty").classList.add("time_select");
      mode = 30;
      console.log(`setting mode=${mode}`);
    });
    document.querySelector(".sixty").addEventListener("click", () => {
      if (mode === 15) {
        document.querySelector(".fifteen").classList.remove("time_select");
      }
      if (mode === 30) {
        document.querySelector(".thirty").classList.remove("time_select");
      }
      if (mode === 60) {
        document.querySelector(".sixty").classList.remove("time_select");
      }
      if (mode === 120) {
        document.querySelector(".twomin").classList.remove("time_select");
      }
      document.querySelector(".sixty").classList.add("time_select");
      mode = 60;
      console.log(`setting mode=${mode}`);
    });
    document.querySelector(".twomin").addEventListener("click", () => {
      if (mode === 15) {
        document.querySelector(".fifteen").classList.remove("time_select");
      }
      if (mode === 30) {
        document.querySelector(".thirty").classList.remove("time_select");
      }
      if (mode === 60) {
        document.querySelector(".sixty").classList.remove("time_select");
      }
      if (mode === 120) {
        document.querySelector(".twomin").classList.remove("time_select");
      }
      document.querySelector(".twomin").classList.add("time_select");
      mode = 120;
      console.log(`setting mode=${mode}`);
    });
    let incomplete = 0;
    let x;
    function timer() {
      let counter = mode + 1;
      go = true;
      x = setInterval(() => {
        counter--;
        console.log("counter sub ");

        if (counter >= 0) {
          change = document.querySelector(".timer");
          change.innerHTML = "";
          minutes = Math.floor(counter / 60);
          seconds = counter % 60;
          if (seconds >= 10) {
            change.innerHTML = `${minutes}:${seconds}`;
          } else {
            change.innerHTML = `${minutes}:0${seconds}`;
          }

          console.log(counter);
        }
        if (counter === 0) {
          change = document.getElementsByClassName(".timer");
          change.innerHTML = "finish";
          console.log(counter);
          incomplete = document
            .querySelector(".quoteType")
            .value.split(" ").length;
          alert("time finished");
          document.querySelector(".bigdiv").style.display = "block";
          document.querySelector(".wpm").style.display = "block";
          wordsTyped += incomplete - 1;
          console.log(incomplete);
          console.log(`words typed=${wordsTyped}`);
          speed = (wordsTyped * 60) / mode;
          document.querySelector(".wpm").innerHTML = `Your wpm is:-${Math.floor(
            speed
          )}`;
        }
      }, 1000);
    }
    document.querySelector(".restart").classList.add("started");
    document.querySelector(".start").addEventListener("click", () => {
      document.querySelector(".restart").classList.remove("started");
      document.querySelector(".start").classList.add("started");
      document.querySelector(".bigdiv").style.display = "none";
      timer();
    });
    document.querySelector(".restart").addEventListener("click", () => {
      document.querySelector(".start").classList.remove("started");
      document.querySelector(".restart").classList.add("started");
      document.querySelector(".bigdiv").style.display = "none";
      wordsTyped = 0;
      getNextQuote();
      clearInterval(x);
    });
    const RANDOM_QUOTE_API_URL = "https://api.quotable.io/random";
    const quoteDisplay = document.querySelector(".quoteDisplay");
    const quoteType = document.querySelector(".quoteType");

    function getRandomQuote() {
      return fetch(RANDOM_QUOTE_API_URL)
        .then((response) => response.json())
        .then((data) => data.content);
    }

    async function getNextQuote() {
      let quote = await getRandomQuote();
      quote = quote.toLowerCase();
      quote = quote.split(".").join("");
      quote = quote.split(";").join("");
      quote = quote.split(",").join("");
      quoteDisplay.innerText = "";
      quote.split("").forEach((character) => {
        const charSpan = document.createElement("span");
        charSpan.innerText = character;
        quoteDisplay.appendChild(charSpan);
      });
      quoteType.value = null;
    }
    let wordsTyped = 0;
    quoteType.addEventListener("input", () => {
      const qsarray = quoteDisplay.querySelectorAll("span");
      console.log(qsarray);
      const vsarray = quoteType.value.split("");
      console.log(vsarray);
      qsarray.forEach((charSpan, index) => {
        const char = vsarray[index];
        if (char == null) {
          charSpan.classList.remove("correct");
          charSpan.classList.remove("incorrect");
          charSpan.classList.add("untyped");
        } else if (char === charSpan.innerText) {
          charSpan.classList.add("correct");
          charSpan.classList.remove("incorrect");
          charSpan.classList.remove("untyped");
        } else {
          charSpan.classList.remove("correct");
          charSpan.classList.add("incorrect");
          charSpan.classList.remove("untyped");
        }
      });
      let correct = true;
      for (let i = 0; i < quoteDisplay.querySelectorAll("span").length; i++) {
        if (
          quoteDisplay.querySelectorAll("span")[i].classList.contains("correct")
        ) {
          continue;
        } else if (
          quoteDisplay
            .querySelectorAll("span")
            [i].classList.contains("untyped") ||
          quoteDisplay
            .querySelectorAll("span")
            [i].classList.contains("incorrect")
        ) {
          correct = false;
          break;
        }
      }

      console.log(correct);
      if (correct) getNextQuote();
      length = document.querySelector(".quoteType").value.split(" ").length;
      if (correct) {
        wordsTyped += length;
      }

      console.log(`words typed=${wordsTyped}`);
      console.log(`length=${length}`);
    });
    console.log(`1.${dummy}`);
    if (dummy) getNextQuote();
    console.log(`2.${dummy}`);
    dummy = false;
    console.log(`3.${dummy}`);

    wordsTyped += incomplete;
    console.log(incomplete);
    console.log(wordsTyped);
  </script>
</html>
